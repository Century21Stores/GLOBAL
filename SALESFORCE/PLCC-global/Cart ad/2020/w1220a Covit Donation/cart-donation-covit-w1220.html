<!-- cart-donation-covit-w1220 - JuanMa - 12.19.19  -->

<style>
.jmr-tc-no-thankyou{
    display: inline-block;
    margin: 2% 0 0;
    border-bottom: solid 1px;
    font-size: 0.7em;
    letter-spacing: 0.05em;
}
.jmr-close-dialog{
    cursor: pointer;
    z-index: 99999;
}
.jm_default_message{
  font-size: 1em;
  margin: 1% auto;
  display: block;
}
.jm-cart-banner-title,
.jm_default_message,
.jm_thank_you_message{
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;    
}
.jm_thank_you_message{
    margin: 4% 0 0;
    display: block;
    font-weight: 600;
    color: #870100;
}
.jm_default_message_2{
    font-weight: bold;
    font-weight: 700;
    margin: 4% 0 0;    
}
#jm_donation_id:target {
    outline: 2px solid #51aeff;
}
#jm_progress_bar{
    width: 10%;
    height: 8px;
    background-color: red;
    text-align: center;
    line-height: 30px;
    display:none;
    margin: 1% 2% 0;
    overflow: hidden;
}
.jmr-full-dialog .jm-cart-banner > div{
    overflow: auto;
}
.jmr-full-dialog .jm-cart-banner-logo-img{
    /*background-image: url('special/tuesday-children/tcbackground_v2.jpg?$staticlink$') !important;*/
    background: #30439B;
    background-repeat: no-repeat;    
    background-position: 50% 0;
    padding-top: calc((2000% / 1600) * 30);
    background-size: cover;
    position: relative;
    width: 30%;
    float: left;
}
.jmr-full-dialog .jm-cart-banner-copy{
    width: 70%;
    float: left;
    position: relative;
    padding: 5% 3%;
}
.jmr-full-dialog .jm-cart-banner-copy h2{
    font-weight: bold;
    font-weight: 700;
    font-size: 2.3em
}
.jm-cart-banner-logo-img img{
    position: absolute;
    display: -webkit-box;
    display: -moz-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    top: 34%;
    left: 14%;
    width: 65%;
}
.jm-cart-banner a.jm-cta-button{
    min-width: 107px;
    max-width: 107px;    
    margin: 0 1%;
}
/* END Donations - Banner on Cart */


@media screen and (min-width: 700px){
.jmr-full-dialog{
    position: fixed;
    width: 100%;
    height: 100%;
    background: #000000ab;
    z-index: 9999;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    display: -webkit-box;
    display: -moz-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
}
.jm-cart-banner{
    z-index: 999999;
    position: relative;
    background: white;
    width: 90%;
}
.{
    min-width: 80px;
    max-width: 80px;
}

}

@media screen and (min-width: 1100px){

}

@media screen and (min-width: 1300px){
.jm-cart-banner{
    width: auto;
}

}


@media screen and (max-width: 700px){
.jm-cart-banner{
    /*background-image: url('special/tuesday-children/tcbackground_v2.jpg?$staticlink$') !important;*/
    background: #30439B;
    background-repeat: no-repeat;    
    /*padding-top: calc((100em / 700) * 100);*/
    background-size: cover;  
    width: 100%;
    position: relative;
    text-align: center;
}
.jmr-tc-no-thankyou{
    text-align: center;
    margin: 0 auto 7%;
    color: white !important;
}
.jmr-full-dialog-mobile{
    margin: 0 0 7%;    
}
.jmr-full-dialog-mobile a{
    min-width: 21vw;
    margin: 0 2vw 3vw;
}
.jmr-full-dialog-mobile .jm-cart-banner-title{
    color: white;
    font-size: 3vw;
    font-weight: 600;
    margin: 5% 0;
    letter-spacing: 0.05em;
}
.jm-cart-banner-logo-img-mobile{
    text-align: center;
    padding: 0 3vw;
}
.jm-cart-banner-logo-img-mobile img{
    width: 50%;
    padding: 6%;
}
.content-block-content__action_mobile{
    text-align: center;    
}
.jm-cart-banner-logo-img{
    position: absolute;
    top: 0.9em;
}
.jm-cart-banner-logo-img img{
    width: 26%;
} 
.jm-cart-banner-logo-img div{
    width: 70%;
}
.jm-cart-banner-title, .jm_default_message, .jm_thank_you_message{
    color: white;
}
.jm-cart-banner .content-block-content__action a{
    padding: 0.75em 1.5em;
    margin: 0.5em 0.5em;
}
.jm-cart-banner .content-block-content__action{
    position: absolute;
    margin: 0;
    bottom: 1em;
}
.jm-cart-banner-subcopy{
    font-size: 3vw;    
}
.jm-shorter{
    padding: 5% 0;
}
.jm-cart-banner .content-block-content__action a{
    /*max-width: 79px;*/
    padding: 0.75em 0em;
    margin: 0.5em 0.4em;
    min-width: 123px;  
}
.jmr-full-dialog{
    position: relative;
    margin: 0 0 7%;   
}
.jmr-close-dialog{
    display: none;
}
.jm_thank_you_message_mobile{
    color: white;
    font-weight: 600;
    letter-spacing: 0.1em;
}
.jmr-mobile-arrow{
    transform: rotate(90deg);
    display: inline-block;
}

}


</style>
<!-- 9899-4913000 , $20 9899-4913000 and  $40 9899-2287000 -->

<script>
console.log('tuesday children Banner');

//DONATIONS
var myWindow;

function openWin40() {
    //myWindow = window.open("myWindow", '_blank', 'toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,left=90000, top=90000, width=1, height=1, visible=none', '');
    //myWindow.document.write("<p>This is 'myWindow'</p>");
    //myWindow.location.replace("https://www.c21stores.com/products/charitydonation-40#thankyouforyourdonation");
    document.getElementById("ifr").src="/products/nyc-health-%2B-hospitals/donate-now/9899-2287000.html?imc=tuesday_children_40&imccat=w1619_cart_top_plcc20#thankyouforyourdonation";
    $('#jm_progress_bar').css('display','block');
    move_pb();
    $('.jm_default_message_2').fadeOut(300);
    $('.jm_thank_you_message').fadeIn(1300);    
    setTimeout(function(){location.reload();}, 5000);    
}
function openWin20() {
    document.getElementById("ifr").src="/products/nyc-health-%2B-hospitals/donate-now/9899-9939000.html?imc=tuesday_children_20&imccat=w1619_cart_top_plcc20#thankyouforyourdonation";
    $('#jm_progress_bar').css('display','block');
    move_pb();
    $('.jm_default_message_2').fadeOut(300);
    $('.jm_thank_you_message').fadeIn(1300);    
    setTimeout(function(){location.reload();}, 5000);    
}
function openWin10() {
    //myWindow = window.open("myWindow", '_blank', 'toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,left=90000, top=90000, width=1, height=1, visible=none', '');
    //myWindow.document.write("<p>This is 'myWindow'</p>");
    //myWindow.location.replace("https://www.c21stores.com/products/charitydonation-10#thankyouforyourdonation");
    document.getElementById("ifr").src="/products/nyc-health-%2B-hospitals/donate-now/9899-4913000.html?imc=tuesday_children_10&imccat=w1619_cart_top_plcc20#thankyouforyourdonation";
    $('#jm_progress_bar').css('display','block');
    move_pb();
    $('.jm_default_message_2').fadeOut(300);
    $('.jm_thank_you_message').fadeIn(1300);
    setTimeout(function(){location.reload();}, 5000);    
}
function openWin5() {
    //myWindow = window.open("myWindow", '_blank', 'toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,left=90000, top=90000, width=1, height=1, visible=none', '');
    //myWindow.document.write("<p>This is 'myWindow'</p>");
    //myWindow.location.replace("https://www.c21stores.com/products/charitydonation-5#thankyouforyourdonation");
    document.getElementById("ifr").src="/products/tuesday%27s-children/%245-donation/9899-9324000.html?imc=tuesday_children_5&imccat=w1619_cart_top_plcc20#thankyouforyourdonation";
    $('#jm_progress_bar').css('display','block');
    move_pb();    
    $('.jm_default_message_2').fadeOut(300);
    $('.jm_thank_you_message').fadeIn(1300);
    setTimeout(function(){location.reload();}, 4000);    
}
function openWin1() {
    //myWindow = window.open("myWindow", '_blank', 'toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,left=90000, top=90000, width=1, height=1, visible=none', '');
    //myWindow.document.write("<p>This is 'myWindow'</p>");
    //myWindow.location.replace("https://www.c21stores.com/products/charitydonation-1#thankyouforyourdonation");
    document.getElementById("ifr").src="/products/tuesday%27s-children/%241-donation/9899-2563000.html?imc=tuesday_children_1&imccat=w1619_cart_top_plcc20#thankyouforyourdonation";
    $('#jm_progress_bar').css('display','block');
    move_pb();
    $('.jm_default_message_2').fadeOut(300);
    $('.jm_thank_you_message').fadeIn(1300);    
    setTimeout(function(){location.reload();}, 4000);    
}

function closeWin() {
    myWindow.close();
}

function move_pb() {
  var elem = document.getElementById("jm_progress_bar");
  var width = 1;
  var id = setInterval(frame, 20);
  function frame() {
    if (width >= 93) {
      clearInterval(id);
    } else {
      width++; 
      elem.style.width = width + '%'; 
    }
  }
}
 

window.addEventListener("DOMContentLoaded", function(){


if (window.location.href.indexOf("/cart") > -1){

    console.log('zero load tc');
    if (localStorage.getItem("hasCodeRunBefore") === null) {
    // ON FIRST LOAD ONLY
        console.log('first load tc');
        const jmr_mq = window.matchMedia( "(min-width: 700px)" );
        if (jmr_mq.matches) {
            console.log('first load tc desktop');
            $(".checkout-btn").one("click mouseover",function(){
                console.log("hover1");
                Tuesday_Children_Dialog();
            });
        } else {
            console.log('first load tc mobile');
            Tuesday_Children_Mobile();
        }

        localStorage.setItem("hasCodeRunBefore", true);
    }
    else{
    // ON SECOND+ LOAD
    const jmr_mq = window.matchMedia( "(min-width: 700px)" );
    console.log('after first load tc');
        // Tuesday_Children_SecondLoad();
        if (jmr_mq.matches) {
            console.log('after first load tc desktop');
            $(".checkout-btn").one("click mouseover",function(){
                console.log("hover2");
                Tuesday_Children_Dialog();
            });
        } else {
            console.log('after first load tc mobile');
            Tuesday_Children_Mobile();
        }
    }

document.onkeydown = function(evt) {
    evt = evt || window.event;
    if (evt.keyCode == 27) {
        jmr_close_dialog();
    }
};


}

function Tuesday_Children_Dialog(){
    console.log('desktop tuesday children');
    $('.cart-page').after(
        '<div role="dialog" class="jmr-full-dialog">'+
        '<a class="jmr-close-dialog jmr-clickable-image" aria-hidden="true" role="none" tabindex="-1" onclick="jmr_close_dialog()"></a>'+
        '<div class="jm-cart-banner">'+
        '<div>'+
            '<div class="jm-cart-banner-logo-img">'+
                '<img src="special/donation/covit.png?$staticlink$"/>'+
            '</div>'+
            '<div class="jm-cart-banner-copy">'+
            '<div>'+
                '<h2 class="jm-cart-banner-title">Together We Can Help</h2>'+
                '<p class="jm-cart-banner-subcopy">'+
                    "<span  class='jm_default_message'>Donate to support NYC Health + Hospitals in their efforts to provide essentials and services to doctors, nurses and other health care workers on the front line.</span>"+
                    "<span  class='jm_default_message_2 jm_default_message'>Choose a donation amount.</span>"+
                    "<span class='jm_thank_you_message' style='display:none'>Thank you for your donation! We are adding it to your cart."+   
                    // "<a id='jm_gptw_main' class='jm_thank_you_message_arrow' href='#jm_donation_id' onclick='jm_scroll_banner(this.id);' onkeypress='jm_scroll_banner(this.id);'> &#8595;</a></span>"+
                    '<span id="jm_progress_bar"></span>'+
                '</p>'+
                '<p class="content-block-content__action content-block-content__action--button">'+
                    // '<a href="#jm_donation_id" class="btn jm-cta-button jm-cta-button-dark" onclick="openWin1()">$1</a>'+
                    // '<a href="#jm_donation_id" class="btn jm-cta-button jm-cta-button-dark" onclick="openWin5(); jm_scroll_banner(this.id)" onkeypress="jm_scroll_banner(this.id);">$5</a>'+
                    '<a href="#jm_donation_id" id="jmr_donate_1" class="btn jm-cta-button jm-cta-button-dark" onclick="openWin10()">$10</a>'+
                    '<a href="#jm_donation_id" class="btn jm-cta-button jm-cta-button-dark" onclick="openWin20()">$20</a>'+          
                    '<a href="#jm_donation_id" class="btn jm-cta-button jm-cta-button-dark" onclick="openWin40()">$40</a>'+
                '</p>'+
                '<a class="jmr-tc-no-thankyou" href="/checkout/login">No Thanks, Continue to Checkout</a>'+
            '</div>'+
            '</div>'+
          '<iframe rel="nofollow" style="display:none; opacity:0;" id="ifr" frameborder="0" src="#" scrolling="no" width="0" height="0">'+
        // '<iframe id="ifr" src="#" scrolling="no" style=" width: 100%; height: 500px; ">'+
        '</div>'+
        '</div>'+
        '</div>'
    );
}

function Tuesday_Children_Mobile(){
    console.log('mobile tuesday children');
    $('.summary-area .card').after(
        '<div class="jmr-full-dialog-mobile">'+
        // '<a class="jmr-close-dialog jmr-clickable-image" aria-hidden="true" role="none" tabindex="-1"></a>'+
        '<div class="jm-cart-banner">'+
        '<div>'+
            '<div class="jm-cart-banner-logo-img-mobile">'+
                '<img src="special/donation/covit.png?$staticlink$"/>'+
                '<div>'+
                    '<h2 class="jm-cart-banner-title">Together We Can Help</h2>'+
                    '<p class="jm-cart-banner-subcopy">'+
                        "<span  class='jm_default_message'>Donate to support NYC Health + Hospitals in their efforts to provide essentials and services to doctors, nurses and other health care workers on the front line.</span>"+
                        "<span  class='jm_default_message_2 jm_default_message'>Choose a donation amount</span>"+
                        "<span class='jm_thank_you_message' style='display:none'>We are adding it to your cart.</span>"+ 
                        "<span class='jm_thank_you_message_mobile' style='display:none'>Thank you for your donation! <span class='jmr-mobile-arrow' onclick='jmr_check_donation_mobile()' >&#8624;</span></span>"+ 
                        // "<a id='jm_gptw_main' class='jm_thank_you_message_arrow' href='#jm_donation_id' onclick='jm_scroll_banner(this.id);' onkeypress='jm_scroll_banner(this.id);'> &#8595;</a></span>"+
                        '<span id="jm_progress_bar"></span>'+
                    '</p>'+
                '</div>'+   
            '</div>'+
            '<p class="content-block-content__action_mobile content-block-content__action--button">'+
                // '<a href="#jm_donation_id" class="jmr-cta-button-soliddark jmr-cta-button btn" onclick="openWin1()">$1</a>'+
                // '<a href="#jm_donation_id" class="jmr-cta-button-soliddark jmr-cta-button btn" onclick="openWin5(); jm_scroll_banner(this.id)" onkeypress="jm_scroll_banner(this.id);">$5</a>'+
                '<a href="#jm_donation_id" class="jmr-cta-button-soliddark jmr-cta-button btn" onclick="openWin10()">$10</a>'+
                '<a href="#jm_donation_id" class="jmr-cta-button-soliddark jmr-cta-button btn" onclick="openWin20()">$20</a>'+
                '<a href="#jm_donation_id" class="jmr-cta-button-soliddark jmr-cta-button btn" onclick="openWin40()">$40</a>'+
            '</p>'+
            // '<span onclick="jmr_close_dialog_mobile()" role="button" class="jmr-thank-you-mobile jmr-tc-no-thankyou" href="">No Thanks, Continue to Checkout</span>'+
        '</div>'+
        '<iframe rel="nofollow" style="display:none; opacity:0;" id="ifr" frameborder="0" src="#" scrolling="no" width="0" height="0">'+
        '</div>'+
        '</div>'
    );
}


$('.cart-wrapper .card .line-item-name').each(function(i){
   console.log($(this).text()); // This is your rel value
    if($(this).text().match('Donate')) {
        $(this).closest('.quantity-info').attr('id', 'jm_donation_id');
        // $(this).closest('.quantity-info').append('<a class="jm-going-back" onclick="jm_scroll_gptw_back(this.id);" onkeypress="jm_scroll_gptw_back(this.id);" href="#" aria-label="Back to main">↵</a>');
        $('.jm-cart-banner .content-block-content__action, .content-block-content__action_mobile, .jmr-thank-you-mobile').fadeOut('fast');
        $('.jm_default_message').fadeOut('fast');        
        $('.jm-cart-banner').addClass('jm-shorter');
        const jmr_mq = window.matchMedia( "(max-width: 700px)" );
        if (jmr_mq.matches) {
            $('.jm_thank_you_message_mobile').fadeIn();
        }
    }       
});

});

//END DONATIONS

function jmr_close_dialog(){
    $('.jmr-full-dialog').remove();
}
function jmr_close_dialog_mobile(){
    $('.jmr-full-dialog-mobile').remove();
}

function jmr_check_donation_mobile(){
    console.log('up!!');
    $('html, body').animate({
        scrollTop: $("div[data-name='Donate Now']").offset().top -100
    }, 1000);    
    
}

// SCROLLING
function jm_scroll_banner(this_id){
    console.log(this_id);
    $('body, html').animate({
        scrollTop: $('#jm_donation_id').offset().top - 533
    }, 1000);
}
function jm_scroll_gptw_back(this_class){
    $('#jm_gptw_main').focus();
    console.log(this_class);
    $('body, html').animate({
        scrollTop: $('#jmr_donate_5').offset().top - 200

    }, 1000);
}
// END SCROLLING

</script>